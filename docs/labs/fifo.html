<!doctype html><html xmlns=http://www.w3.org/1999/xhtml lang=en xml:lang=en><meta charset=utf-8><meta name=generator content="quarto-1.7.33"><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes"><title>fifo – Operating System (2025 Fall)</title><style>code{white-space:pre-wrap}span.smallcaps{font-variant:small-caps}div.columns{display:flex;gap:min(4vw,1.5em)}div.column{flex:auto;overflow-x:auto}div.hanging-indent{margin-left:1.5em;text-indent:-1.5em}ul.task-list{list-style:none}ul.task-list li input[type=checkbox]{width:.8em;margin:0 .8em .2em -1em;vertical-align:middle}html{-webkit-text-size-adjust:100%}pre>code.sourceCode{white-space:pre;position:relative}pre>code.sourceCode>span{display:inline-block;line-height:1.25}pre>code.sourceCode>span:empty{height:1.2em}.sourceCode{overflow:visible}code.sourceCode>span{color:inherit;text-decoration:inherit}div.sourceCode{margin:1em 0}pre.sourceCode{margin:0}@media screen{div.sourceCode{overflow:auto}}@media print{pre>code.sourceCode{white-space:pre-wrap}pre>code.sourceCode>span{text-indent:-5em;padding-left:5em}}pre.numberSource code{counter-reset:source-line 0}pre.numberSource code>span{position:relative;left:-4em;counter-increment:source-line}pre.numberSource code>span>a:first-child::before{content:counter(source-line);position:relative;left:-1em;text-align:right;vertical-align:baseline;border:none;display:inline-block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 4px;width:4em}pre.numberSource{margin-left:3em;padding-left:4px}div.sourceCode{}@media screen{pre>code.sourceCode>span>a:first-child::before{text-decoration:underline}}</style><script src=../site_libs/quarto-nav/quarto-nav.js></script><script src=../site_libs/clipboard/clipboard.min.js></script><script src=../site_libs/quarto-search/autocomplete.umd.js></script><script src=../site_libs/quarto-search/fuse.min.js></script><script src=../site_libs/quarto-search/quarto-search.js></script><meta name=quarto:offset content="../"><link href=../images/orange.png rel=icon type=image/png><script src=../site_libs/quarto-html/quarto.js type=module></script><script src=../site_libs/quarto-html/tabsets/tabsets.js type=module></script><script src=../site_libs/quarto-html/popper.min.js></script><script src=../site_libs/quarto-html/tippy.umd.min.js></script><script src=../site_libs/quarto-html/anchor.min.js></script><link href=../site_libs/quarto-html/tippy.css rel=stylesheet><link href=../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css rel=stylesheet id=quarto-text-highlighting-styles><script src=../site_libs/bootstrap/bootstrap.min.js></script><link href=../site_libs/bootstrap/bootstrap-icons.css rel=stylesheet><link href=../site_libs/bootstrap/bootstrap-a3d6f4078ec9f2632a80ad631344d584.min.css rel=stylesheet append-hash=true id=quarto-bootstrap data-mode=light><script id=quarto-search-options type=application/json>{"location":"navbar","copy-button":false,"collapse-after":3,"panel-placement":"end","type":"overlay","limit":50,"keyboard-shortcut":["f","/","s"],"show-item-context":false,"language":{"search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search"}}</script><body class="nav-sidebar docked nav-fixed fullcontent quarto-light"><div id=quarto-search-results></div><header id=quarto-header class="headroom fixed-top"><nav class="navbar navbar-expand-lg" data-bs-theme=dark><div class="navbar-container container-fluid"><div class="navbar-brand-container mx-auto"><a class=navbar-brand href=../index.html><span class=navbar-title>Operating System (2025 Fall)</span></a></div><div id=quarto-search title=Search></div><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarCollapse aria-controls=navbarCollapse role=menu aria-expanded=false aria-label="Toggle navigation" onclick=window.quartoToggleHeadroom&&window.quartoToggleHeadroom()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarCollapse><ul class="navbar-nav navbar-nav-scroll me-auto"><li class=nav-item><a class="nav-link active" href=../index.html aria-current=page><span class=menu-text>Home</span></a><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=nav-menu-handouts role=link data-bs-toggle=dropdown aria-expanded=false><span class=menu-text>Handouts</span></a><ul class=dropdown-menu aria-labelledby=nav-menu-handouts><li><a class=dropdown-item href=../handouts/env_setup.html><span class=dropdown-text>Enviroment setup</span></a></ul><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=nav-menu-admin role=link data-bs-toggle=dropdown aria-expanded=false><span class=menu-text>Admin</span></a><ul class=dropdown-menu aria-labelledby=nav-menu-admin><li><a class=dropdown-item href=../admin/policies.html><span class=dropdown-text>Policies</span></a><li><a class=dropdown-item href=../admin/explore.html><span class=dropdown-text>Exploratory Projects</span></a><li><a class=dropdown-item href=../admin/waitbutwhy.html><span class=dropdown-text>SD1↓ (燒蛋一下)</span></a></ul></ul><ul class="navbar-nav navbar-nav-scroll ms-auto"><li class="nav-item compact"><a class=nav-link href=https://dcs.site.nthu.edu.tw/><i class="bi bi-globe" role=img></i><span class=menu-text></span></a></ul></div><div class=quarto-navbar-tools></div></div></nav><nav class=quarto-secondary-nav><div class="container-fluid d-flex"><button type=button class="quarto-btn-toggle btn" data-bs-toggle=collapse role=button data-bs-target=.quarto-sidebar-collapse-item aria-controls=quarto-sidebar aria-expanded=false aria-label="Toggle sidebar navigation" onclick=window.quartoToggleHeadroom&&window.quartoToggleHeadroom()>
<i class="bi bi-layout-text-sidebar-reverse"></i></button><nav class=quarto-page-breadcrumbs aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=../weeks/w5.html>Worksheet 5</a><li class=breadcrumb-item><a href=../labs/fifo.html>FIFO (named pipe)</a></ol></nav><a class=flex-grow-1 role=navigation data-bs-toggle=collapse data-bs-target=.quarto-sidebar-collapse-item aria-controls=quarto-sidebar aria-expanded=false aria-label="Toggle sidebar navigation" onclick=window.quartoToggleHeadroom&&window.quartoToggleHeadroom()></a><button type=button class="btn quarto-search-button" aria-label=Search onclick=window.quartoOpenSearch()>
<i class="bi bi-search"></i></button></div></nav></header><div id=quarto-content class="quarto-container page-columns page-rows-contents page-layout-article page-navbar"><nav id=quarto-sidebar class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center"><div class=sidebar-search><div id=quarto-search title=Search></div></div></div><div class=sidebar-menu-container><ul class="list-unstyled mt-1"><li class=sidebar-item><div class=sidebar-item-container><a href=../index.html class="sidebar-item-text sidebar-link"><span class=menu-text>OS 2025 Fall</span></a></div><li class="sidebar-item sidebar-item-section"><div class=sidebar-item-container><a href=../weeks/w2.html class="sidebar-item-text sidebar-link"><span class=menu-text>Worksheet 2</span></a>
<a class="sidebar-item-toggle text-start collapsed" data-bs-toggle=collapse data-bs-target=#quarto-sidebar-section-1 role=navigation aria-expanded=false aria-label="Toggle section"><i class="bi bi-chevron-right ms-2"></i></a></div><ul id=quarto-sidebar-section-1 class="collapse list-unstyled sidebar-section depth1"><li class=sidebar-item><div class=sidebar-item-container><a href=../handouts/env_setup.html class="sidebar-item-text sidebar-link"><span class=menu-text>Environment setup</span></a></div></ul><li class="sidebar-item sidebar-item-section"><div class=sidebar-item-container><a href=../weeks/w3.html class="sidebar-item-text sidebar-link"><span class=menu-text>Worksheet 3</span></a>
<a class="sidebar-item-toggle text-start collapsed" data-bs-toggle=collapse data-bs-target=#quarto-sidebar-section-2 role=navigation aria-expanded=false aria-label="Toggle section"><i class="bi bi-chevron-right ms-2"></i></a></div><ul id=quarto-sidebar-section-2 class="collapse list-unstyled sidebar-section depth1"><li class=sidebar-item><div class=sidebar-item-container><a href=../handouts/unix.html class="sidebar-item-text sidebar-link"><span class=menu-text>Unix Philosophy</span></a></div><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/mini-cloud.html class="sidebar-item-text sidebar-link"><span class=menu-text>Your First Week in OS Journey</span></a></div><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/process-creation.html class="sidebar-item-text sidebar-link"><span class=menu-text><code>fork()</code>/<code>exec()</code></span></a></div></ul><li class="sidebar-item sidebar-item-section"><div class=sidebar-item-container><a href=../weeks/w4.html class="sidebar-item-text sidebar-link"><span class=menu-text>Worksheet 4</span></a>
<a class="sidebar-item-toggle text-start collapsed" data-bs-toggle=collapse data-bs-target=#quarto-sidebar-section-3 role=navigation aria-expanded=false aria-label="Toggle section"><i class="bi bi-chevron-right ms-2"></i></a></div><ul id=quarto-sidebar-section-3 class="collapse list-unstyled sidebar-section depth1"><li class=sidebar-item><div class=sidebar-item-container><a href=../handouts/privilege.html class="sidebar-item-text sidebar-link"><span class=menu-text>Privilege</span></a></div><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/path-traversal.html class="sidebar-item-text sidebar-link"><span class=menu-text>Lab: Path Traversal Attack</span></a></div><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/process-address-space.html class="sidebar-item-text sidebar-link"><span class=menu-text>Address Space Layout</span></a></div><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/linking.html class="sidebar-item-text sidebar-link"><span class=menu-text>Static vs Dynamic Linking</span></a></div></ul><li class="sidebar-item sidebar-item-section"><div class=sidebar-item-container><a href=../weeks/w5.html class="sidebar-item-text sidebar-link"><span class=menu-text>Worksheet 5</span></a>
<a class="sidebar-item-toggle text-start" data-bs-toggle=collapse data-bs-target=#quarto-sidebar-section-4 role=navigation aria-expanded=true aria-label="Toggle section"><i class="bi bi-chevron-right ms-2"></i></a></div><ul id=quarto-sidebar-section-4 class="collapse list-unstyled sidebar-section depth1 show"><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/pipe-passwords.html class="sidebar-item-text sidebar-link"><span class=menu-text>Parallelizing Rainbow Table Lookup with Pipes</span></a></div><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/pipe-dup.html class="sidebar-item-text sidebar-link"><span class=menu-text>Pipes, Redirection, and File Descriptors</span></a></div><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/fifo.html class="sidebar-item-text sidebar-link active"><span class=menu-text>FIFO (named pipe)</span></a></div></ul><li class="sidebar-item sidebar-item-section"><div class=sidebar-item-container><a href=../weeks/w6.html class="sidebar-item-text sidebar-link"><span class=menu-text>Worksheet 6</span></a>
<a class="sidebar-item-toggle text-start collapsed" data-bs-toggle=collapse data-bs-target=#quarto-sidebar-section-5 role=navigation aria-expanded=false aria-label="Toggle section"><i class="bi bi-chevron-right ms-2"></i></a></div><ul id=quarto-sidebar-section-5 class="collapse list-unstyled sidebar-section depth1"><li class=sidebar-item><div class=sidebar-item-container><a href=../handouts/scheduler.html class="sidebar-item-text sidebar-link"><span class=menu-text>Schedulers</span></a></div><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/process-state.html class="sidebar-item-text sidebar-link"><span class=menu-text>Process States in Linux</span></a></div><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/pipe-pingpong.html class="sidebar-item-text sidebar-link"><span class=menu-text>Pipe Pingpong</span></a></div></ul><li class="sidebar-item sidebar-item-section"><div class=sidebar-item-container><a href=../weeks/w8.html class="sidebar-item-text sidebar-link"><span class=menu-text>Worksheet 8</span></a>
<a class="sidebar-item-toggle text-start collapsed" data-bs-toggle=collapse data-bs-target=#quarto-sidebar-section-6 role=navigation aria-expanded=false aria-label="Toggle section"><i class="bi bi-chevron-right ms-2"></i></a></div><ul id=quarto-sidebar-section-6 class="collapse list-unstyled sidebar-section depth1"><li class=sidebar-item><div class=sidebar-item-container><a href=../handouts/buffercache.html class="sidebar-item-text sidebar-link"><span class=menu-text>Caching and Buffering</span></a></div><li class=sidebar-item><div class=sidebar-item-container><a href=../labs/cat.html class="sidebar-item-text sidebar-link"><span class=menu-text>How <code>cat</code> works?</span></a></div></ul></ul></div></nav><div id=quarto-sidebar-glass class=quarto-sidebar-collapse-item data-bs-toggle=collapse data-bs-target=.quarto-sidebar-collapse-item></div><main class=content id=quarto-document-content><header id=title-block-header class=quarto-title-block><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=../weeks/w5.html>Worksheet 5</a><li class=breadcrumb-item><a href=../labs/fifo.html>FIFO (named pipe)</a></ol></nav></header><section id=fifo-named-pipe class=level2><h2 class=anchored data-anchor-id=fifo-named-pipe>FIFO (named pipe)</h2><p>Niko rushes into the office. “Nini! Help! Our client’s server has a process that is stuck! It just hangs and never finishes!”<p>Nini looked up from her screen 黑人問號 and asked. “A stuck process? Or is it waiting for something?”<p>“Let me teach you some basics about pipe. This will be a piece of fish.”<section id=basic-pipe-behavior class=level3><h3 class=anchored data-anchor-id=basic-pipe-behavior>Basic Pipe Behavior</h3><p>“First, let’s create a simple named pipe,” Nini said.<p>Now it’s your turn. Open a terminal and follow along with Niko’s debugging session.<p><strong>Your Task:</strong> Create a pipe and try to write the current time into it.<div class=sourceCode id=cb1><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb1-1><a href=#cb1-1 aria-hidden=true tabindex=-1></a><span class=fu>mkfifo</span> F</span>
<span id=cb1-2><a href=#cb1-2 aria-hidden=true tabindex=-1></a><span class=fu>date</span> +%s <span class=op>&gt;</span> F</span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p>After running the second command, you will see that your terminal is “stuck”. It doesn’t return to the command prompt. This is what Niko saw on the client’s server. This is <strong>blocking</strong>. The <code>date</code> command is waiting because no process is reading from the other end of the pipe.<p><strong>Your Task:</strong> Press <code>Ctrl+C</code> to interrupt the command and get your prompt back. Then, verify that you created a pipe using <code>ls -l</code>. The file <code>F</code> should have a type <strong>p</strong>.</section><section id=investigating-multiple-blocked-processes class=level3><h3 class=anchored data-anchor-id=investigating-multiple-blocked-processes>Investigating Multiple Blocked Processes</h3><p>Nini continued: “Now let’s see what happens with multiple writers.”<p><strong>Your Task:</strong> Create two new pipes, <code>A</code> and <code>B</code>.<div class=sourceCode id=cb2><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb2-1><a href=#cb2-1 aria-hidden=true tabindex=-1></a><span class=fu>mkfifo</span> A</span>
<span id=cb2-2><a href=#cb2-2 aria-hidden=true tabindex=-1></a><span class=fu>mkfifo</span> B</span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p><strong>Your Task:</strong> Now, run the following commands. The <code>&</code> symbol will run the first two commands in the background. Your terminal will block on the third command. Take note of the Process IDs (PIDs) that are printed for the background jobs.<div class=sourceCode id=cb3><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb3-1><a href=#cb3-1 aria-hidden=true tabindex=-1></a><span class=fu>date</span> +%s <span class=op>&gt;</span> A <span class=kw>&amp;</span></span>
<span id=cb3-2><a href=#cb3-2 aria-hidden=true tabindex=-1></a><span class=fu>date</span> +%s <span class=op>&gt;</span> B <span class=kw>&amp;</span></span>
<span id=cb3-3><a href=#cb3-3 aria-hidden=true tabindex=-1></a><span class=fu>date</span> +%s <span class=op>&gt;</span> C</span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p>“Good,” said Nini. “Now, let’s dig deeper and investigate one of the background processes.”<p><strong>Your Task:</strong> In a <strong>new terminal window</strong> (since your other one is blocked), investigate one of the PIDs you noted down. Replace <code>[PID]</code> with the actual process ID.<ol type=1><li><strong>Check the process list:</strong> See if your process is running.</ol><div class=sourceCode id=cb4><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb4-1><a href=#cb4-1 aria-hidden=true tabindex=-1></a><span class=fu>ps</span> aux <span class=kw>|</span> <span class=fu>grep</span> <span class=pp>[</span><span class=ss>PID</span><span class=pp>]</span></span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><ol start=2 type=1><li><strong>Trace the system calls:</strong> Use <code>strace</code> to see what the process is asking the kernel to do.</ol><div class=sourceCode id=cb5><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb5-1><a href=#cb5-1 aria-hidden=true tabindex=-1></a><span class=ex>strace</span> <span class=at>-p</span> <span class=pp>[</span><span class=ss>PID</span><span class=pp>]</span></span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p>Look at the output. What system call is your process stuck in? It is waiting for something to happen.<ol start=3 type=1><li><strong>Look inside <code>/proc</code>:</strong> The <code>/proc</code> filesystem gives you a direct look into the kernel’s data about processes.</ol><div class=sourceCode id=cb6><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb6-1><a href=#cb6-1 aria-hidden=true tabindex=-1></a><span class=fu>cat</span> /proc/<span class=pp>[</span><span class=ss>PID</span><span class=pp>]</span>/cmdline <span class=co># show the process's command</span></span>
<span id=cb6-2><a href=#cb6-2 aria-hidden=true tabindex=-1></a><span class=fu>ls</span> /proc/<span class=pp>[</span><span class=ss>PID</span><span class=pp>]</span>/fdinfo/   <span class=co># list open file descriptors</span></span>
<span id=cb6-3><a href=#cb6-3 aria-hidden=true tabindex=-1></a><span class=fu>cat</span> /proc/<span class=pp>[</span><span class=ss>PID</span><span class=pp>]</span>/fdinfo/<span class=pp>*</span> <span class=co># see details about the file descriptors</span></span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p>Do you see the file descriptor for the pipe you opened? Is the process name what you expect?</section><section id=reading-from-the-pipes class=level3><h3 class=anchored data-anchor-id=reading-from-the-pipes>Reading from the Pipes</h3><p>“The writers are all patiently waiting,” Nini explained. “They will remain blocked until a reader opens the other end of the pipe. Let’s unblock them.”<p><strong>Your Task:</strong> In the terminal where you ran the <code>strace</code> and <code>ps</code> commands, run <code>cat</code>. This command will read from the pipes.<div class=sourceCode id=cb7><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb7-1><a href=#cb7-1 aria-hidden=true tabindex=-1></a><span class=fu>cat</span> <span class=at>-n</span> A B</span>
<span id=cb7-2><a href=#cb7-2 aria-hidden=true tabindex=-1></a><span class=fu>cat</span> C</span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p>As soon as you run <code>cat</code>, you will see the timestamps appear. <code>cat</code> reads the data, which <strong>unblocks</strong> the waiting <code>date</code> processes, allowing them to finish. Your original terminal will also become unblocked.<p><strong>Question:</strong> Look at the output. Are the timestamps from <code>A</code> and <code>C</code> the same?</section><section id=a-test-of-precision-with-python class=level3><h3 class=anchored data-anchor-id=a-test-of-precision-with-python>A Test of Precision with Python</h3><p>“The <code>date</code> command only has a precision of one second,” Nini explained. “Let’s try an experiment with more precise timing. We will use a simple Python command to get microseconds.”<p><strong>Your Task:</strong> First, clean up the old pipes and create new ones.<div class=sourceCode id=cb8><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb8-1><a href=#cb8-1 aria-hidden=true tabindex=-1></a><span class=fu>rm</span> A B</span>
<span id=cb8-2><a href=#cb8-2 aria-hidden=true tabindex=-1></a><span class=fu>mkfifo</span> A B</span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p>Next, create a shell alias. This is a shortcut for a longer command.<div class=sourceCode id=cb9><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb9-1><a href=#cb9-1 aria-hidden=true tabindex=-1></a><span class=bu>alias</span> P=<span class=st>'python3 -c "from datetime import datetime; print(datetime.now().strftime(\"%H:%M:%S.%f\"))"'</span></span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p><strong>Your Task:</strong> Now, run the writers again, just like before.<div class=sourceCode id=cb10><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb10-1><a href=#cb10-1 aria-hidden=true tabindex=-1></a><span class=ex>P</span> <span class=op>&gt;</span> B <span class=kw>&amp;</span></span>
<span id=cb10-2><a href=#cb10-2 aria-hidden=true tabindex=-1></a><span class=ex>P</span> <span class=op>&gt;</span> A <span class=kw>&amp;</span></span>
<span id=cb10-3><a href=#cb10-3 aria-hidden=true tabindex=-1></a><span class=ex>P</span> <span class=op>&gt;</span> C</span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p>And then, read the results.<div class=sourceCode id=cb11><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb11-1><a href=#cb11-1 aria-hidden=true tabindex=-1></a><span class=fu>cat</span> <span class=at>-n</span> A B C</span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p><strong>Question:</strong> Compare the microsecond precision of the timestamps in your output. Are they identical or different? How do they compare to the <code>date</code> command results from earlier?<p><strong>Question:</strong> Why might Python show different microsecond values while the <code>date</code> command showed identical timestamps?</section><section id=order-dependency class=level3><h3 class=anchored data-anchor-id=order-dependency>Order Dependency</h3><p>“Okay, final test,” Nini said. “You have seen what happens when the writer starts before the reader. What do you predict will happen if you start the reader <em>before</em> any writers?”<p><strong>Your Task:</strong> Let’s run the experiment. First, start over again:<div class=sourceCode id=cb12><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb12-1><a href=#cb12-1 aria-hidden=true tabindex=-1></a><span class=fu>rm</span> A B</span>
<span id=cb12-2><a href=#cb12-2 aria-hidden=true tabindex=-1></a><span class=fu>mkfifo</span> A B</span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p>Now, run the reader (<code>cat</code>) in the background <strong>first</strong>, then run the writers.<div class=sourceCode id=cb13><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id=cb13-1><a href=#cb13-1 aria-hidden=true tabindex=-1></a><span class=fu>cat</span> <span class=at>-n</span> A B <span class=kw>&amp;</span></span>
<span id=cb13-2><a href=#cb13-2 aria-hidden=true tabindex=-1></a><span class=fu>date</span> +%s <span class=op>&gt;</span> A <span class=kw>&amp;</span></span>
<span id=cb13-3><a href=#cb13-3 aria-hidden=true tabindex=-1></a><span class=fu>date</span> +%s <span class=op>&gt;</span> B <span class=kw>&amp;</span></span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div><p>Observe what happened in your terminal.<ol type=1><li>What was different this time compared to the first experiment?<li>Did the writer processes (<code>date</code>) block, or did they execute immediately?<li>How does this outcome help you understand the blocking behavior of pipes?</ol></section></section><section id=questions class=level2><h2 class=anchored data-anchor-id=questions>Questions</h2><p>Nini smiled. “You’ve done well. You have seen how processes communicate with pipes. Now, to make sure you understood, answer these questions.”<ol type=1><li><p>When you ran <code>date +%s > A &</code>, what was the process name shown by <code>ps</code>? Was it <code>date</code>? Why or why not? (Hint: Think about what the shell does <em>before</em> it runs the <code>date</code> command).<li><p>Why did your Python experiment show different microsecond timestamps while the <code>date</code> commands showed identical timestamps? (Hint: Think about how many processes are created and when the timestamps are generated).<li><p>Here is a simplified C code snippet that shows what the shell does to run a command like <code>date > A</code>. Explain what the <code>dup2</code> system call does. At which point — <code>(1)</code>, <code>(2)</code>, <code>(3)</code>, or <code>(4)</code> — does the writer process block if no reader is present?</ol><div class=sourceCode id=cb14><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id=cb14-1><a href=#cb14-1 aria-hidden=true tabindex=-1></a><span class=dt>int</span> main<span class=op>()</span> <span class=op>{</span></span>
<span id=cb14-2><a href=#cb14-2 aria-hidden=true tabindex=-1></a>    pid_t pid<span class=op>;</span></span>
<span id=cb14-3><a href=#cb14-3 aria-hidden=true tabindex=-1></a></span>
<span id=cb14-4><a href=#cb14-4 aria-hidden=true tabindex=-1></a>    pid <span class=op>=</span> fork<span class=op>();</span></span>
<span id=cb14-5><a href=#cb14-5 aria-hidden=true tabindex=-1></a>    <span class=cf>if</span> <span class=op>(</span>pid <span class=op>==</span> <span class=dv>0</span><span class=op>)</span> <span class=op>{</span> <span class=co>// This is the child process</span></span>
<span id=cb14-6><a href=#cb14-6 aria-hidden=true tabindex=-1></a>        <span class=co>/* (1) */</span></span>
<span id=cb14-7><a href=#cb14-7 aria-hidden=true tabindex=-1></a>        <span class=dt>int</span> fd <span class=op>=</span> open<span class=op>(</span><span class=st>"A"</span><span class=op>,</span> O_WRONLY<span class=op>);</span></span>
<span id=cb14-8><a href=#cb14-8 aria-hidden=true tabindex=-1></a></span>
<span id=cb14-9><a href=#cb14-9 aria-hidden=true tabindex=-1></a>        <span class=co>/* (2) */</span></span>
<span id=cb14-10><a href=#cb14-10 aria-hidden=true tabindex=-1></a>        dup2<span class=op>(</span>fd<span class=op>,</span> STDOUT_FILENO<span class=op>);</span> <span class=co>// STDOUT_FILENO is file descriptor 1</span></span>
<span id=cb14-11><a href=#cb14-11 aria-hidden=true tabindex=-1></a>        close<span class=op>(</span>fd<span class=op>);</span></span>
<span id=cb14-12><a href=#cb14-12 aria-hidden=true tabindex=-1></a></span>
<span id=cb14-13><a href=#cb14-13 aria-hidden=true tabindex=-1></a>        <span class=co>/* (3) */</span></span>
<span id=cb14-14><a href=#cb14-14 aria-hidden=true tabindex=-1></a>        execlp<span class=op>(</span><span class=st>"date"</span><span class=op>,</span> <span class=st>"date"</span><span class=op>,</span> NULL<span class=op>);</span> <span class=co>// Replace this process with 'date'</span></span>
<span id=cb14-15><a href=#cb14-15 aria-hidden=true tabindex=-1></a>    <span class=op>}</span></span>
<span id=cb14-16><a href=#cb14-16 aria-hidden=true tabindex=-1></a></span>
<span id=cb14-17><a href=#cb14-17 aria-hidden=true tabindex=-1></a>    <span class=co>/* (4) */</span> <span class=co>// This is the parent process</span></span>
<span id=cb14-18><a href=#cb14-18 aria-hidden=true tabindex=-1></a><span class=op>}</span></span></code><button title="Copy to Clipboard" class=code-copy-button><i class=bi></i></button></pre></div></section><a onclick="return window.scrollTo(0,0),!1" role=button id=quarto-back-to-top><i class="bi bi-arrow-up"></i> Back to top</a></main><script id=quarto-html-after-body>window.document.addEventListener("DOMContentLoaded",function(){const j="",c=new window.AnchorJS;c.options={placement:"right",icon:j},c.add(".anchored");const v=e=>{for(const t of e.classList)if(t.startsWith("code-annotation-"))return!0;return!1},p=function(e){const t=e.trigger;t.blur(),t.classList.add("code-copy-button-checked");var s=t.getAttribute("title");t.setAttribute("title","Copied!");let n;window.bootstrap&&(t.setAttribute("data-bs-toggle","tooltip"),t.setAttribute("data-bs-placement","left"),t.setAttribute("data-bs-title","Copied!"),n=new bootstrap.Tooltip(t,{trigger:"manual",customClass:"code-copy-button-tooltip",offset:[0,-8]}),n.show()),setTimeout(function(){n&&(n.hide(),t.removeAttribute("data-bs-title"),t.removeAttribute("data-bs-toggle"),t.removeAttribute("data-bs-placement")),t.setAttribute("title",s),t.classList.remove("code-copy-button-checked")},1e3),e.clearSelection()},m=function(e){const t=e.previousElementSibling.cloneNode(!0);for(const e of t.children)v(e)&&e.remove();return t.innerText},b=new window.ClipboardJS(".code-copy-button:not([data-in-quarto-modal])",{text:m});if(b.on("success",p),window.document.getElementById("quarto-embedded-source-code-modal")){const e=new window.ClipboardJS(".code-copy-button[data-in-quarto-modal]",{text:m,container:window.document.getElementById("quarto-embedded-source-code-modal")});e.on("success",p)}for(var s,g=new RegExp(/^(?:http|https):\/\/localhost:?[0-9]*\//),x=new RegExp(/^mailto:/),O=new RegExp("/"+window.location.host+"/"),w=e=>O.test(e)||g.test(e)||x.test(e),u=window.document.querySelectorAll("a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)"),t=0;t<u.length;t++){const e=u[t];w(e.href)||(e.dataset.originalHref!==0[0]&&(e.href=e.dataset.originalHref),e.setAttribute("target","_blank"),e.getAttribute("rel")===null&&e.setAttribute("rel","noopener"),e.classList.add("external"))}function i(e,t,n,s){const o={allowHTML:!0,maxWidth:500,delay:100,arrow:!1,appendTo:function(e){return e.parentElement},interactive:!0,interactiveBorder:10,theme:"quarto",placement:"bottom-start"};t&&(o.content=t),n&&(o.onTrigger=n),s&&(o.onUntrigger=s),window.tippy(e,o)}const f=window.document.querySelectorAll('a[role="doc-noteref"]');for(t=0;t<f.length;t++){const e=f[t];i(e,function(){let t=e.getAttribute("data-footnote-href")||e.getAttribute("href");try{t=new URL(t).hash}catch{}const s=t.replace(/^#\/?/,""),n=window.document.getElementById(s);return n?n.innerHTML:""})}const r=window.document.querySelectorAll("a.quarto-xref"),o=(e,t)=>{const n=e=>{if(e.classList.remove("page-full","page-columns"),e.children)for(const t of e.children)n(t)};if(n(t),e===null||e.startsWith("sec-")){const e=document.createElement("div");if(t.children&&t.children.length>2){e.appendChild(t.children[0].cloneNode(!0));for(let n=1;n<t.children.length;n++){const s=t.children[n];if(s.tagName==="P"&&s.innerText==="")continue;e.appendChild(s.cloneNode(!0));break}return window.Quarto?.typesetMath&&window.Quarto.typesetMath(e),e.innerHTML}return window.Quarto?.typesetMath&&window.Quarto.typesetMath(t),t.innerHTML}else{const e=t.querySelector("a.anchorjs-link");return e&&e.remove(),window.Quarto?.typesetMath&&window.Quarto.typesetMath(t),t.classList.contains("callout")?t.outerHTML:t.innerHTML}};for(t=0;t<r.length;t++){const e=r[t];i(e,0[0],function(t){t.disable();let n=e.getAttribute("href"),s=0[0];if(n.startsWith("#"))s=n;else try{s=new URL(n).hash}catch{}if(s){const e=s.replace(/^#\/?/,""),i=window.document.getElementById(e);if(i!==null)try{const n=o(e,i.cloneNode(!0));t.setContent(n)}finally{t.enable(),t.show()}else fetch(n.split("#")[0]).then(e=>e.text()).then(n=>{const i=new DOMParser,a=i.parseFromString(n,"text/html"),s=a.getElementById(e);if(s!==null){const n=o(e,s);t.setContent(n)}}).finally(()=>{t.enable(),t.show()})}else fetch(n).then(e=>e.text()).then(e=>{const s=new DOMParser,i=s.parseFromString(e,"text/html"),n=i.querySelector("main.content");if(n!==null){n.children.length>0&&n.children[0].tagName==="HEADER"&&n.children[0].remove();const e=o(null,n);t.setContent(e)}}).finally(()=>{t.enable(),t.show()})},function(){})}let n;const h=(e,t)=>{let n='data-code-cell="'+e+'"',s='data-code-annotation="'+t+'"';const o="span["+n+"]["+s+"]";return o},a=e=>{const d=window.document,i=e.getAttribute("data-target-cell"),r=e.getAttribute("data-target-annotation"),c=window.document.querySelector(h(i,r)),l=c.getAttribute("data-code-lines").split(","),t=l.map(e=>i+"-"+e);let s=null,o=null,a=null;if(t.length>0){const r=window.document.getElementById(t[0]);if(s=r.offsetTop,o=r.offsetHeight,a=r.parentElement.parentElement,t.length>1){const e=window.document.getElementById(t[t.length-1]),n=e.offsetTop+e.offsetHeight;o=n-s}if(s!==null&&o!==null&&a!==null){let e=window.document.getElementById("code-annotation-line-highlight");e===null&&(e=window.document.createElement("div"),e.setAttribute("id","code-annotation-line-highlight"),e.style.position="absolute",a.appendChild(e)),e.style.top=s-2+"px",e.style.height=o+4+"px",e.style.left=0;let t=window.document.getElementById("code-annotation-line-highlight-gutter");if(t===null){t=window.document.createElement("div"),t.setAttribute("id","code-annotation-line-highlight-gutter"),t.style.position="absolute";const e=window.document.getElementById(i),n=e.querySelector(".code-annotation-gutter");n.appendChild(t)}t.style.top=s-2+"px",t.style.height=o+4+"px"}n=e}},y=()=>{const e=["code-annotation-line-highlight","code-annotation-line-highlight-gutter"];e.forEach(e=>{const t=window.document.getElementById(e);t&&t.remove()}),n=0[0]};window.addEventListener("resize",_(()=>{elRect=0[0],n&&a(n)},10));function _(e,t){let s=!1,n;return(...o)=>{s?(n&&clearTimeout(n),n=setTimeout(()=>{e.apply(this,o),n=s=!1},t)):(e.apply(this,o),s=!0)}}const d=window.document.querySelectorAll(".code-annotation-anchor");for(let e=0;e<d.length;e++){const t=d[e],n=t.getAttribute("data-target-cell"),s=t.getAttribute("data-target-annotation"),o=()=>{const e=window.document.querySelector(h(n,s));if(e){const t=e.cloneNode(!0);return t.classList.add("code-annotation-tip-content"),t.outerHTML}},i={allowHTML:!0,content:o,onShow:e=>{a(e.reference),e.reference.classList.add("code-annotation-active"),window.tippy.hideAll()},onHide:e=>{y(),e.reference.classList.remove("code-annotation-active")},maxWidth:300,delay:[50,0],duration:[200,0],offset:[5,10],arrow:!0,appendTo:function(e){return e.parentElement.parentElement.parentElement},interactive:!0,interactiveBorder:10,theme:"quarto",placement:"right",popperOptions:{modifiers:[{name:"flip",options:{flipVariations:!1,allowedAutoPlacements:["right"],fallbackPlacements:["right","top","top-start","top-end","bottom","bottom-start","bottom-end","left"]}},{name:"preventOverflow",options:{mainAxis:!1,altAxis:!1}}]}};window.tippy(t,i)}const l=e=>{const t=e.parentElement;if(t){const n=t.dataset.cites;return n?{el:e,cites:n.split(" ")}:l(e.parentElement)}else return 0[0]};for(s=window.document.querySelectorAll('a[role="doc-biblioref"]'),t=0;t<s.length;t++){const n=s[t],e=l(n);e&&i(e.el,function(){var t=window.document.createElement("div");return e.cites.forEach(function(e){var s,n=window.document.createElement("div");n.classList.add("hanging-indent"),n.classList.add("csl-entry"),s=window.document.getElementById("ref-"+e),s&&(n.innerHTML=s.innerHTML),t.appendChild(n)}),t.innerHTML})}})</script></div><footer class=footer><div class=nav-footer><div class=nav-footer-left><p><img id=footer-cat-left src=../images/cat-left.png alt="Cat Left"></div><div class=nav-footer-center><p><span id=footer-center>Made with ❤️ by Tony, (CC&nbsp;BY&nbsp;4.0)<br><span style=font-size:8px>Cat source: Freepik and ChatGPT</span></span></div><div class=nav-footer-right><p><img id=footer-cat-right src=../images/cat-right.png alt="Cat Right"></div></div></footer>